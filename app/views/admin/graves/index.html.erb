<!-- app/views/admin/graves/index.html.erb -->
<!-- 墓所一覧ページ -->
<div class="container">
  <div class="d-flex justify-content-between align-items-center my-4">
    <h3>墓所一覧</h3>
    <%= link_to "新規登録", new_admin_grave_path, class: "btn btn-primary" %>
  </div>

  <table class="table table-hover">
    <thead class="thead-light">
      <tr>
        <th>ID</th>
        <th>名称</th>
        <th>画像</th>
        <th>都道府県</th>
        <th>登録日時</th>
        <th>ジャンル</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @graves.each do |grave| %>
        <tr>
          <td><%= grave.id %></td>
          <td><%= grave.name %></td>
          <td>
            <% if grave.main_image.attached? %>
              <%= image_tag grave.main_image.variant(resize_to_limit: [100, 100]) %>
            <% else %>
              <p>画像はありません</p>
            <% end %>
          </td>
          <td><%= grave.prefecture %></td>
          <td><%= l grave.created_at, format: :short %></td>
          <td><%= grave.genres.pluck(:name).join(', ') %></td>
          <td>
            <%= link_to "詳細", admin_grave_path(grave), class: "btn btn-info btn-sm" %>
            <%= link_to "編集", edit_admin_grave_path(grave), class: "btn btn-success btn-sm" %>
            <%= link_to "削除", admin_grave_path(grave), method: :delete, data: { confirm: "本当に削除しますか？" }, class: "btn btn-danger btn-sm" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>